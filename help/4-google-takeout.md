# <span style="color:green">üóÉÔ∏è Google Takeout Management</span>


From version 1.0.0 onwards, the Tool can process your Google Photos Takeout files to fix timestamp, geodata, organize files per year/month, organize assets within album(s) in subfolders, etc...

## Process Explained

- To execute the Google Takeout Processing, you need to call the tool with the argument _**`-gTakeout, --google-takeout <INPUT_TAKEOUT_FOLDER>`**_.   

- Where, `<INPUT_TAKEOUT_FOLDER>` is the folder that content the Google Takeout to process (if the Takeout is in Zip files, it will be extracted first into folder `<INPUT_TAKEOUT_FOLDER>_unzipped`.  

- If you execute the tool without arguments or with your Takeout folder as unique argument by default the tool will execute the Feature **Google Takeout Process** (requesting the user to select the Takeout folder if not detected). 

- The Takeout Processing can be configured with different settings, depending on the arguments used during the call to the Tool.

- The whole process will do the following posible Steps (depending on which flag/arguments are enabled):  

### Steps during Takeout Processing:

0. Pre-Check the `<TAKEOUT_FOLDER>` and Unzip all the Takeout Zips (if it is in ZIP format) into a subfolder named `./<TAKEOUT_FOLDER>_unzipped_<TIMESTAMP>` (by default).
   
1. Pre-Process `<TAKEOUT_FOLDER>` unzipped to delete `@eaDir` subfolders (Synology metadata subfolders with miniatures) and to Fix .MP4 files extracted from Live pictures and with no .json file associated.

2. Use GPTH Tool to process all .json files and fix date of all photos/videos found on Takeout folder and organize them into the output folder (This step can be skipped using argument _`gsgt, --google-skip-gpth-tool`_).

3. Copy/Move files to output folder manually if GPTH processing was skipped in previous step
  
4. Sync Timestamps of .MP4 files generated by Google Photos with Live Picture files (.heic, .jpg, .jpeg) if both files have the same name and are in the same folder

5. Create Date Folder structure (`flatten`, `year`, `year/month`, `year-month`) to Albums and No Albums folders according to the options given by arguments:
   - _`-gafs, --google-albums-folders-structure`_ <`flatten`, `year`, `year/month`, `year-month`>. Applies to each Album folder. Default is ‚Äòflatten‚Äô for Albums
   - _`-gnas, --google-no-albums-folders-structure`_ <`flatten`, `year`, `year/month`, `year-month`> Applies to ALL_PHOTOS folder (Photos without any Albums). Default is ‚Äòyear/month‚Äô for No-Albums. 

6. Move all the Albums into `<OUTPUT_FOLDER>/Albums` subfolder and the Photos that does not belong to any album to `<OUTPUT_FOLDER>/No-Albums` folder. This step can be skipped using argument _`-gsma, --google-skip-move-albums`_

7. After that, the Tool will look in the `<OUTPUT_FOLDER>` for any symbolic link broken and will try to fix it by looking for the original file where the symlink is pointing to.

8. After that, the Tool will Count all Valid Albums on `<OUTPUT_FOLDER>` folder. 

9. (Optional) If flag `--grdf, --google-remove-duplicates-files` is detected, the Tool will look for any duplicate file on `<OUTPUT_FOLDER>` (ignoring symbolic links), and will remove all duplicates keeping only the principal file (giving more priority to duplicates files found into any album folder than those found on `ALL_PHOTOS` folder. 

10. (Optional) If flag `--graf, --google-rename-albums-folders` is detected, the Tool rename all albums folders within `<OUTPUT_FOLDER>` based on content dates.

> [!NOTE]  
> Step 9 is disabled by default, and is only recommended if you want to save disk space and want to avoid having the same physical file in more than one folder (in case that the same file belongs to multiples Albums).   
> 
> Step 10 is disabled by default, but it would be very usefull if you want to homogenize all your albums folders names (see Folder Rename Content Based Extra Feature).  
>

The result will be a folder named `<TAKEOUT_FOLDER>_<SUFFIX>_<TIMESTAMP>` by default, but you can or change the default suffix _`processed`_ by any other using the option _`-gofs, --google-output-folder-suffix <SUFFIX>`_) 
The final `<OUTPUT_FOLDER>` will include:
- `Albums` subfolder with all the Albums without year/month structure (by default).
- `No-Albums` subfolder with all the photos with year/month structure (by default).

> [!TIP]
> If you want to use your processed assets within Synology Photos, you just need to move `OUTPUT_FOLDER` into your /home/Photos folder and let Synology index all files (it will take long time). 
>
> After that you will be able to explore your photos chronologically on the Synology Photos App, and all your Albums will be there when you explore the library by folder instead of chronologically.

> [!NOTE]
> It was very useful for me when I run it to process more than **300 GB** of Photos and Albums from Google Photos (408559 files zipped, 168168 photos/video files, 740 albums) and moved it into Synology Photos.  
> 
> The whole process took around **~8 hours** (or ~11 hours if includes optional step 9) and this is the time split per steps:  
> 
> 0. Pre-Checks & Extraction process --> 1h 30m
> 1. Pre-processing Takeout folder --> 7m
> 2. GPTH Tool fixing --> 6h
> 3. <span style="color:grey">(Optional) Copy/Move files to output folder manually if GPTH processing was skipped --> 0h</span>
> 4. Sync .MP4 timestamps --> 10s
> 5. Create Date Folder Structure --> 50s
> 6. Moving Album Folder --> 1s
> 7. Fix Broken Symlinks --> 10m
> 8. Count Valid Albums --> 1s
> 9. <span style="color:grey">(Optional) Remove Duplicates after fixing --> 3h</span>
> 10. <span style="color:grey">(Optional) Rename Albums Folders after fixing --> 1m</span>
>
> NOTE: Above times are approximates and were measured running the tool on Linux using a Synology NAS DS920+.


## **Examples of use:**

- **Example 1:**
```
./PhotoMigrator.run --google-takeout ./MyTakeout --google-remove-duplicates-files
```
 
In this example, the tool will do the Takeout Processing with the following steps:
1. Process you Takeout Files found in folder `./MyTakeout` (Unzipping them if needed) and fix all files found to set the correct date and time, and identifying which assets belongs to each Album created on Google Photos. 
2. Create a folder structure based on year/month for the folder `<OUTPUT_TAKEOUT_FOLDER>/No-Albums` (by default).  
3. Create a flatten folder structure for each Album subfolder found in `<OUTPUT_TAKEOUT_FOLDER>/Albums` (by default).    
4. Move the files will into `./MyTakeout_processed_timestamp` folder where timestamp is the timestamp of the execution.
5. Remove any duplicates files found in `./MyTakeout_processed_timestamp` folder


- **Example 2:**
```
./PhotoMigrator.run --google-takeout ./MyTakeout --google-remove-duplicates-files google-create-symbolic-albums
```
 
In this example, the tool will do the Takeout Processing with the following steps:
1. Process you Takeout Files found in folder `./MyTakeout` (Unzipping them if needed) and fix all files found to set the correct date and time, and identifying which assets belongs to each Album created on Google Photos to create symbolic links for each asset in any Album to the original file stored in `No-Albums` subfolder.  
2. Create a folder structure based on year/month for the folder `<OUTPUT_TAKEOUT_FOLDER>/No-Albums` (by default).  
3. Create a flatten folder structure for each Album subfolder found in `<OUTPUT_TAKEOUT_FOLDER>/Albums` (by default).    
4. Move the files will into `./MyTakeout_processed_timestamp` folder where timestamp is the timestamp of the execution.
5. Remove any duplicates files found in `./MyTakeout_processed_timestamp` folder


> [!TIP]
> ## <span style="color:dark">Additional Tip</span>
> When prepare Google Takeout to export all your Photos and Albums, select 50GB for the zip file size and select Google Drive as output for those Zip files.  
>
> On this way you can just Download all the big Zip files directly on your Synology NAS by using the Tool Cloud Sync (included on Synology App Store) and creating a new synchronization task from your Google Drive account (/Takeout folder) to any local folder of your Synology NAS.

---

## üè† [Back to Main Page](https://github.com/jaimetur/PhotoMigrator/blob/main/README.md)


---
## üéñÔ∏è Credits:
I hope this can be useful for any of you. Enjoy it!

<span style="color:grey">(c) 2024-2025 by Jaime Tur (@jaimetur).</span>  
